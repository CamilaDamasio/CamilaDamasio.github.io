{"ast":null,"code":"import _objectSpread from\"/home/camila/Repositorios_GitHub/project-recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/home/camila/Repositorios_GitHub/project-recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/home/camila/Repositorios_GitHub/project-recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/camila/Repositorios_GitHub/project-recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/camila/Repositorios_GitHub/project-recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/camila/Repositorios_GitHub/project-recipes-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useParams,Redirect}from'react-router-dom';import{Button,Form}from'react-bootstrap';import ShareBtn from'../components/ShareBtn';import whiteHeartIcon from\"../images/whiteHeartIcon.svg\";import blackHeartIcon from\"../images/blackHeartIcon.svg\";import{drinkById}from'../utils/fetchAPIbyID';import useRedirect from'../hooks/useRedirect';import HeaderWithoutSearch from'../components/HeaderWithoutSearch';function DrinksInProgress(){var _useParams=useParams(),id=_useParams.id;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),drinkDetails=_useState2[0],setDrinkDetails=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),progress=_useState4[0],setProgress=_useState4[1];var _useRedirect=useRedirect(),shouldRedirect=_useRedirect.shouldRedirect,redirect=_useRedirect.redirect;var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),disabled=_useState6[0],setDisabled=_useState6[1];useEffect(function(){var fetchDrink=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var drink,inProgressRecipes,cocktails,loadedProgress,inputs;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return drinkById(id);case 2:drink=_context.sent;setDrinkDetails(drink);inProgressRecipes=JSON.parse(localStorage.getItem('inProgressRecipes'));if(inProgressRecipes&&progress.length===0&&Object.keys(inProgressRecipes.cocktails).some(function(key){return key===id;})){cocktails=inProgressRecipes.cocktails;loadedProgress=cocktails[id];setProgress(loadedProgress);inputs=document.querySelectorAll('input');if(inputs){inputs.forEach(function(input){if(loadedProgress.some(function(value){return value===input.parentElement.querySelector('label').innerText;})){input.defaultChecked=true;input.parentElement.querySelector('label').style.textDecoration='line-through';}});}}case 6:case\"end\":return _context.stop();}}},_callee);}));return function fetchDrink(){return _ref.apply(this,arguments);};}();var favoriteRecipes=JSON.parse(localStorage.getItem('favoriteRecipes'));if(favoriteRecipes){var isFavorite=function isFavorite(){return favoriteRecipes.some(function(recipe){return recipe.id===id;})&&document.getElementById('fav-btn').setAttribute('src',blackHeartIcon);};isFavorite();}fetchDrink();},[id,progress]);var retObj=Object.entries(drinkDetails);var listIngredients=retObj.filter(function(drink){return drink[0].includes('Ingredient')&&drink[1];});var filterAlcoohol=retObj.filter(function(drink){var noAlcool=drink[1]!==' '&&drink[1]!==null;return drink[0].includes('Measure')&&noAlcool;});var progressRecipe=function progressRecipe(labelValue){var updatedProgress=[];if(!progress.some(function(value){return value===labelValue;})){updatedProgress=progress.concat(labelValue);setProgress(updatedProgress);}else{updatedProgress=progress.filter(function(ingredient){return ingredient!==labelValue;});setProgress(updatedProgress);}var inProgressRecipes=JSON.parse(localStorage.getItem('inProgressRecipes'));if(!inProgressRecipes){inProgressRecipes={cocktails:_defineProperty({},id,updatedProgress)};}else{var _inProgressRecipes=inProgressRecipes,cocktails=_inProgressRecipes.cocktails;if(inProgressRecipes.cocktails){cocktails[id]=updatedProgress;}else{var recipeProgress=_defineProperty({},id,_toConsumableArray(updatedProgress));cocktails=_objectSpread(_objectSpread({},cocktails),recipeProgress);}inProgressRecipes.cocktails=cocktails;}localStorage.setItem('inProgressRecipes',JSON.stringify(inProgressRecipes));};var finishRecipe=function finishRecipe(){var strCategory=drinkDetails.strCategory,strDrinkThumb=drinkDetails.strDrinkThumb,strDrink=drinkDetails.strDrink,strTags=drinkDetails.strTags;var d=new Date();var dataDMY=\"\".concat(d.getDay(),\"/\").concat(d.getMonth(),\"/\").concat(d.getFullYear());var dataTIME=\"\".concat(d.getHours(),\"hrs\").concat(d.getMinutes(),\"min\");var arrTag;if(strTags){arrTag=strTags.split(',');}else{arrTag=null;}var finishedRecipeToken={id:id,type:'bebida',area:null,category:strCategory,alcoholicOrNot:null,name:strDrink,image:strDrinkThumb,doneDate:\"\".concat(dataDMY,\" \\xE0s \").concat(dataTIME),tags:arrTag};var inProgressRecipes=JSON.parse(localStorage.getItem('inProgressRecipes'));if((Object.keys(inProgressRecipes).length&&Object.keys(inProgressRecipes.cocktails).length)===1){localStorage.removeItem('inProgressRecipes');}else{delete inProgressRecipes.cocktails[id];}var doneRecipes=JSON.parse(localStorage.getItem('doneRecipes'));if(doneRecipes){doneRecipes.push(finishedRecipeToken);}else{doneRecipes=[finishedRecipeToken];}localStorage.setItem('doneRecipes',JSON.stringify(doneRecipes));shouldRedirect('/receitas-feitas');};var isDisabled=function isDisabled(){var el=document.querySelectorAll('input');if(!Array.from(el).every(function(x){return x.checked;})){setDisabled(true);}else{setDisabled(false);}};var setFavorite=function setFavorite(){var strDrinkThumb=drinkDetails.strDrinkThumb,strDrink=drinkDetails.strDrink,strAlcoholic=drinkDetails.strAlcoholic,strCategory=drinkDetails.strCategory;var favoriteRecipeToken={id:id,type:'bebida',area:'',category:strCategory,alcoholicOrNot:strAlcoholic,name:strDrink,image:strDrinkThumb};var favoriteRecipes=JSON.parse(localStorage.getItem('favoriteRecipes'));if(favoriteRecipes){if(favoriteRecipes.every(function(recipe){return recipe.id!==favoriteRecipeToken.id;})){favoriteRecipes.push(favoriteRecipeToken);document.getElementById('fav-btn').setAttribute('src',blackHeartIcon);}else{favoriteRecipes=favoriteRecipes.filter(function(recipe){return recipe.id!==favoriteRecipeToken.id;});document.getElementById('fav-btn').setAttribute('src',whiteHeartIcon);}}else{favoriteRecipes=[favoriteRecipeToken];document.getElementById('fav-btn').setAttribute('src',blackHeartIcon);}localStorage.setItem('favoriteRecipes',JSON.stringify(favoriteRecipes));if(Object.values(favoriteRecipes).length===0){localStorage.removeItem('favoriteRecipes');}};return/*#__PURE__*/React.createElement(\"div\",{onChange:isDisabled,className:\"in-progress\"},redirect.should&&/*#__PURE__*/React.createElement(Redirect,{to:redirect.path}),/*#__PURE__*/React.createElement(HeaderWithoutSearch,null,\"Receita em progresso\"),/*#__PURE__*/React.createElement(\"img\",{src:drinkDetails.strDrinkThumb,alt:\"imagem da bebida\",\"data-testid\":\"recipe-photo\",className:\"in-progress-pic\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"detail-card\"},/*#__PURE__*/React.createElement(\"h2\",{\"data-testid\":\"recipe-title\"},drinkDetails.strDrink),/*#__PURE__*/React.createElement(\"div\",{className:\"details-btn-div\"},/*#__PURE__*/React.createElement(ShareBtn,{id:id,type:\"bebida\"}),/*#__PURE__*/React.createElement(Button,{className:\"favorite-btn\",variant:\"danger\",type:\"button\",onClick:setFavorite},/*#__PURE__*/React.createElement(\"img\",{id:\"fav-btn\",className:\"icon\",src:whiteHeartIcon,alt:\"favoritar\",\"data-testid\":\"favorite-btn\"})))),/*#__PURE__*/React.createElement(\"p\",{\"data-testid\":\"recipe-category\"},/*#__PURE__*/React.createElement(\"span\",null,\"Categoria: \"),drinkDetails.strAlcoholic),/*#__PURE__*/React.createElement(\"div\",{className:\"list-ingredients\"},/*#__PURE__*/React.createElement(\"h4\",null,\"Ingredientes\"),/*#__PURE__*/React.createElement(\"ul\",null,listIngredients.map(function(ingredient,index){return/*#__PURE__*/React.createElement(\"li\",{key:index,\"data-testid\":\"\".concat(index,\"-ingredient-step\"),className:\"in-progress-list\"},/*#__PURE__*/React.createElement(Form.Group,{className:\"mb-3\",controlId:\"\".concat(index,\"-ingredient-step\")},/*#__PURE__*/React.createElement(Form.Check,{type:\"checkbox\",id:\"\".concat(index,\"-ingredient-step\"),label:filterAlcoohol[index]?\"\".concat(ingredient[1],\" - \").concat(filterAlcoohol[index][1]):ingredient[1],onChange:function onChange(_ref2){var target=_ref2.target;var label=target.parentElement;progressRecipe(label.innerText);if(target.checked){label.style.textDecoration='line-through';}else if(!target.checked){target.defaultChecked=false;label.style.textDecoration='none';}}})));}))),/*#__PURE__*/React.createElement(\"strong\",null,\"Instru\\xE7\\xF5es: \"),/*#__PURE__*/React.createElement(\"p\",{className:\"instructions\",\"data-testid\":\"instructions\"},drinkDetails.strInstructions),/*#__PURE__*/React.createElement(Button,{disabled:disabled,type:\"button\",\"data-testid\":\"finish-recipe-btn\",className:\"finishRecipe\",onClick:finishRecipe},\"Finalizar Receita\"));}export default DrinksInProgress;","map":{"version":3,"sources":["/home/camila/Repositorios_GitHub/project-recipes-app/src/pages/DrinksInProgress.jsx"],"names":["React","useState","useEffect","useParams","Redirect","Button","Form","ShareBtn","drinkById","useRedirect","HeaderWithoutSearch","DrinksInProgress","id","drinkDetails","setDrinkDetails","progress","setProgress","shouldRedirect","redirect","disabled","setDisabled","fetchDrink","drink","inProgressRecipes","JSON","parse","localStorage","getItem","length","Object","keys","cocktails","some","key","loadedProgress","inputs","document","querySelectorAll","forEach","input","value","parentElement","querySelector","innerText","defaultChecked","style","textDecoration","favoriteRecipes","isFavorite","recipe","getElementById","setAttribute","blackHeartIcon","retObj","entries","listIngredients","filter","includes","filterAlcoohol","noAlcool","progressRecipe","labelValue","updatedProgress","concat","ingredient","recipeProgress","setItem","stringify","finishRecipe","strCategory","strDrinkThumb","strDrink","strTags","d","Date","dataDMY","getDay","getMonth","getFullYear","dataTIME","getHours","getMinutes","arrTag","split","finishedRecipeToken","type","area","category","alcoholicOrNot","name","image","doneDate","tags","removeItem","doneRecipes","push","isDisabled","el","Array","from","every","x","checked","setFavorite","strAlcoholic","favoriteRecipeToken","whiteHeartIcon","values","should","path","map","index","target","label","strInstructions"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, Redirect } from 'react-router-dom';\nimport { Button, Form } from 'react-bootstrap';\nimport ShareBtn from '../components/ShareBtn';\nimport whiteHeartIcon from '../images/whiteHeartIcon.svg';\nimport blackHeartIcon from '../images/blackHeartIcon.svg';\nimport { drinkById } from '../utils/fetchAPIbyID';\nimport useRedirect from '../hooks/useRedirect';\nimport HeaderWithoutSearch from '../components/HeaderWithoutSearch';\n\nfunction DrinksInProgress() {\n  const { id } = useParams();\n  const [drinkDetails, setDrinkDetails] = useState({});\n  const [progress, setProgress] = useState([]);\n  const { shouldRedirect, redirect } = useRedirect();\n  const [disabled, setDisabled] = useState(true);\n  useEffect(() => {\n    const fetchDrink = async () => {\n      const drink = await drinkById(id);\n      setDrinkDetails(drink);\n      const inProgressRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n      if (inProgressRecipes && progress\n        .length === 0 && Object.keys(inProgressRecipes.cocktails)\n        .some((key) => key === id)) {\n        const { cocktails } = inProgressRecipes;\n        const loadedProgress = cocktails[id];\n        setProgress(loadedProgress);\n        const inputs = document.querySelectorAll('input');\n        if (inputs) {\n          inputs.forEach((input) => {\n            if (loadedProgress.some((value) => value === input.parentElement\n              .querySelector('label').innerText)) {\n              input.defaultChecked = true;\n              input.parentElement\n                .querySelector('label').style.textDecoration = 'line-through';\n            }\n          });\n        }\n      }\n    };\n    const favoriteRecipes = JSON.parse(localStorage.getItem('favoriteRecipes'));\n    if (favoriteRecipes) {\n      const isFavorite = () => favoriteRecipes\n        .some((recipe) => recipe.id === id) && document.getElementById('fav-btn')\n        .setAttribute('src', blackHeartIcon);\n      isFavorite();\n    }\n    fetchDrink();\n  }, [id, progress]);\n\n  const retObj = Object.entries(drinkDetails);\n  const listIngredients = retObj.filter((drink) => (\n    drink[0].includes('Ingredient') && drink[1]\n  ));\n  const filterAlcoohol = retObj.filter((drink) => {\n    const noAlcool = drink[1] !== ' ' && drink[1] !== null;\n    return drink[0].includes('Measure') && noAlcool;\n  });\n\n  const progressRecipe = (labelValue) => {\n    let updatedProgress = [];\n    if (!progress.some((value) => value === labelValue)) {\n      updatedProgress = progress.concat(labelValue);\n      setProgress(updatedProgress);\n    } else {\n      updatedProgress = progress.filter((ingredient) => ingredient !== labelValue);\n      setProgress(updatedProgress);\n    }\n    let inProgressRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n    if (!inProgressRecipes) {\n      inProgressRecipes = {\n        cocktails: { [id]: updatedProgress },\n      };\n    } else {\n      let { cocktails } = inProgressRecipes;\n      if (inProgressRecipes.cocktails) {\n        cocktails[id] = updatedProgress;\n      } else {\n        const recipeProgress = { [id]: [...updatedProgress] };\n        cocktails = { ...cocktails, ...recipeProgress };\n      }\n      inProgressRecipes.cocktails = cocktails;\n    }\n    localStorage.setItem('inProgressRecipes', JSON.stringify(inProgressRecipes));\n  };\n\n  const finishRecipe = () => {\n    const { strCategory, strDrinkThumb, strDrink, strTags } = drinkDetails;\n    const d = new Date();\n    const dataDMY = `${d.getDay()}/${d.getMonth()}/${d.getFullYear()}`;\n    const dataTIME = `${d.getHours()}hrs${d.getMinutes()}min`;\n    let arrTag;\n    if (strTags) {\n      arrTag = strTags.split(',');\n    } else {\n      arrTag = null;\n    }\n    const finishedRecipeToken = {\n      id,\n      type: 'bebida',\n      area: null,\n      category: strCategory,\n      alcoholicOrNot: null,\n      name: strDrink,\n      image: strDrinkThumb,\n      doneDate: `${dataDMY} às ${dataTIME}`,\n      tags: arrTag,\n    };\n    const inProgressRecipes = JSON.parse(localStorage.getItem('inProgressRecipes'));\n    if ((Object.keys(inProgressRecipes)\n      .length && Object.keys(inProgressRecipes.cocktails).length) === 1) {\n      localStorage.removeItem('inProgressRecipes');\n    } else {\n      delete inProgressRecipes.cocktails[id];\n    }\n    let doneRecipes = JSON.parse(localStorage.getItem('doneRecipes'));\n    if (doneRecipes) {\n      doneRecipes.push(finishedRecipeToken);\n    } else {\n      doneRecipes = [finishedRecipeToken];\n    }\n    localStorage.setItem('doneRecipes', JSON.stringify(doneRecipes));\n    shouldRedirect('/receitas-feitas');\n  };\n\n  const isDisabled = () => {\n    const el = document.querySelectorAll('input');\n    if (!(Array.from(el).every((x) => x.checked))) {\n      setDisabled(true);\n    } else {\n      setDisabled(false);\n    }\n  };\n  const setFavorite = () => {\n    const { strDrinkThumb, strDrink, strAlcoholic, strCategory } = drinkDetails;\n    const favoriteRecipeToken = {\n      id,\n      type: 'bebida',\n      area: '',\n      category: strCategory,\n      alcoholicOrNot: strAlcoholic,\n      name: strDrink,\n      image: strDrinkThumb,\n    };\n    let favoriteRecipes = JSON.parse(localStorage.getItem('favoriteRecipes'));\n    if (favoriteRecipes) {\n      if (favoriteRecipes.every((recipe) => recipe.id !== favoriteRecipeToken.id)) {\n        favoriteRecipes.push(favoriteRecipeToken);\n        document.getElementById('fav-btn').setAttribute('src', blackHeartIcon);\n      } else {\n        favoriteRecipes = favoriteRecipes\n          .filter((recipe) => recipe.id !== favoriteRecipeToken.id);\n        document.getElementById('fav-btn').setAttribute('src', whiteHeartIcon);\n      }\n    } else {\n      favoriteRecipes = [favoriteRecipeToken];\n      document.getElementById('fav-btn').setAttribute('src', blackHeartIcon);\n    }\n    localStorage.setItem('favoriteRecipes', JSON.stringify(favoriteRecipes));\n    if (Object.values(favoriteRecipes).length === 0) {\n      localStorage.removeItem('favoriteRecipes');\n    }\n  };\n  return (\n    <div onChange={ isDisabled } className=\"in-progress\">\n      { redirect.should && <Redirect to={ redirect.path } />}\n      <HeaderWithoutSearch>Receita em progresso</HeaderWithoutSearch>\n      <img\n        src={ drinkDetails.strDrinkThumb }\n        alt=\"imagem da bebida\"\n        data-testid=\"recipe-photo\"\n        className=\"in-progress-pic\"\n      />\n      <div className=\"detail-card\">\n        <h2 data-testid=\"recipe-title\">{ drinkDetails.strDrink }</h2>\n        <div className=\"details-btn-div\">\n          <ShareBtn id={ id } type=\"bebida\" />\n          <Button\n            className=\"favorite-btn\"\n            variant=\"danger\"\n            type=\"button\"\n            onClick={ setFavorite }\n          >\n            <img\n              id=\"fav-btn\"\n              className=\"icon\"\n              src={ whiteHeartIcon }\n              alt=\"favoritar\"\n              data-testid=\"favorite-btn\"\n            />\n          </Button>\n        </div>\n      </div>\n      <p data-testid=\"recipe-category\">\n        <span>Categoria: </span>\n        { drinkDetails.strAlcoholic }\n      </p>\n      <div className=\"list-ingredients\">\n        <h4>Ingredientes</h4>\n        <ul>\n          {listIngredients.map((ingredient, index) => (\n            <li\n              key={ index }\n              data-testid={ `${index}-ingredient-step` }\n              className=\"in-progress-list\"\n            >\n              <Form.Group className=\"mb-3\" controlId={ `${index}-ingredient-step` }>\n                <Form.Check\n                  type=\"checkbox\"\n                  id={ `${index}-ingredient-step` }\n                  label={ filterAlcoohol[index] ? (\n                    `${ingredient[1]} - ${filterAlcoohol[index][1]}`\n                  ) : (ingredient[1]) }\n                  onChange={ ({ target }) => {\n                    const label = target.parentElement;\n                    progressRecipe(label.innerText);\n                    if (target.checked) {\n                      label.style.textDecoration = 'line-through';\n                    } else if (!target.checked) {\n                      target.defaultChecked = false;\n                      label.style.textDecoration = 'none';\n                    }\n                  } }\n                />\n              </Form.Group>\n            </li>\n          ))}\n        </ul>\n      </div>\n      <strong>Instruções: </strong>\n      <p\n        className=\"instructions\"\n        data-testid=\"instructions\"\n      >\n        { drinkDetails.strInstructions }\n      </p>\n      <Button\n        disabled={ disabled }\n        type=\"button\"\n        data-testid=\"finish-recipe-btn\"\n        className=\"finishRecipe\"\n        onClick={ finishRecipe }\n      >\n        Finalizar Receita\n      </Button>\n    </div>\n  );\n}\nexport default DrinksInProgress;\n"]},"metadata":{},"sourceType":"module"}